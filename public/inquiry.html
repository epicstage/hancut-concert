<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë¬¸ì˜í•˜ê¸° - í•œë™í›ˆ í† í¬ì½˜ì„œíŠ¸</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#dc2626',
            'primary-dark': '#b91c1c',
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="/styles.css?v=3" />
  <style>
    /* ë¬¸ì˜ í˜ì´ì§€ ì „ìš© ìŠ¤íƒ€ì¼ */
    .step-indicator {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 2rem;
    }

    .step-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--color-border);
      transition: all 0.3s ease;
    }

    .step-dot.active {
      background: var(--color-primary);
      transform: scale(1.2);
    }

    .step-dot.completed {
      background: var(--color-success);
    }

    .category-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .category-card {
      padding: 1rem;
      border: 2px solid var(--color-border);
      border-radius: 12px;
      background: white;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
    }

    .category-card:hover {
      border-color: var(--color-primary);
      background: rgba(220, 38, 38, 0.05);
    }

    .category-card.selected {
      border-color: var(--color-primary);
      background: rgba(220, 38, 38, 0.1);
    }

    .category-card .icon {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .category-card .label {
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--color-text);
    }

    .char-counter {
      text-align: right;
      font-size: 0.75rem;
      color: var(--color-text-muted);
      margin-top: 0.25rem;
    }

    .char-counter.warning {
      color: #f59e0b;
    }

    .char-counter.danger {
      color: var(--color-error);
    }

    .inquiry-card {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      margin-bottom: 1rem;
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--color-border);
    }

    .inquiry-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      background: rgba(0, 0, 0, 0.02);
      border-bottom: 1px solid var(--color-border);
    }

    .inquiry-status {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0.375rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .inquiry-status.waiting {
      background: #fef3c7;
      color: #92400e;
    }

    .inquiry-status.answered {
      background: #d1fae5;
      color: #065f46;
    }

    .inquiry-card-body {
      padding: 1rem;
    }

    .inquiry-category {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      background: rgba(220, 38, 38, 0.1);
      color: var(--color-primary);
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
    }

    .inquiry-content {
      color: var(--color-text);
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .answer-section {
      margin-top: 1rem;
      padding: 1rem;
      background: #f0fdf4;
      border-radius: 12px;
      border-left: 4px solid var(--color-success);
    }

    .answer-label {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--color-success);
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.375rem;
    }

    .faq-section {
      margin-bottom: 2rem;
    }

    .faq-item {
      background: white;
      border-radius: 12px;
      margin-bottom: 0.5rem;
      overflow: hidden;
      border: 1px solid var(--color-border);
    }

    .faq-question {
      width: 100%;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 0.9375rem;
      font-weight: 500;
      color: var(--color-text);
      text-align: left;
    }

    .faq-question:hover {
      background: rgba(0, 0, 0, 0.02);
    }

    .faq-chevron {
      width: 20px;
      height: 20px;
      transition: transform 0.2s ease;
      color: var(--color-text-muted);
    }

    .faq-item.open .faq-chevron {
      transform: rotate(180deg);
    }

    .faq-answer {
      display: none;
      padding: 0 1rem 1rem;
      color: var(--color-text-muted);
      font-size: 0.875rem;
      line-height: 1.6;
    }

    .faq-item.open .faq-answer {
      display: block;
    }

    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 12px;
      font-size: 0.875rem;
      z-index: 1000;
      opacity: 0;
      transition: all 0.3s ease;
      pointer-events: none;
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    .user-info-banner {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      background: rgba(220, 38, 38, 0.1);
      border-radius: 12px;
      margin-bottom: 1.5rem;
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      background: var(--color-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
    }

    .user-info-text {
      flex: 1;
    }

    .user-name {
      font-weight: 600;
      color: var(--color-text);
    }

    .user-phone {
      font-size: 0.75rem;
      color: var(--color-text-muted);
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(12px);
      border-top: 1px solid var(--color-border);
      padding: 0.75rem;
      padding-bottom: calc(0.75rem + env(safe-area-inset-bottom));
      z-index: 40;
      display: flex;
      gap: 0.5rem;
    }

    .bottom-nav a,
    .bottom-nav button {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 0.5rem;
      border-radius: 12px;
      font-size: 0.75rem;
      color: var(--color-text-muted);
      text-decoration: none;
      background: none;
      border: none;
      cursor: pointer;
      min-height: var(--touch-target-min);
    }

    .bottom-nav a:hover,
    .bottom-nav button:hover {
      background: rgba(0, 0, 0, 0.05);
    }

    .bottom-nav a.active {
      color: var(--color-primary);
    }

    .bottom-nav svg {
      width: 24px;
      height: 24px;
      margin-bottom: 0.25rem;
    }

    @media (min-width: 768px) {
      .bottom-nav {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="min-h-screen bg-gradient-to-br from-red-50 via-white to-sky-50" style="padding-bottom: 80px;">
    <!-- í—¤ë” -->
    <header class="glass-header sticky top-0 z-50">
      <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
        <a href="/" class="flex items-center gap-2 text-gray-900 hover:text-gray-600 transition-colors">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
          <span class="font-medium">ëŒì•„ê°€ê¸°</span>
        </a>
        <h1 class="text-lg font-bold">ë¬¸ì˜í•˜ê¸°</h1>
        <div class="w-20"></div>
      </div>
    </header>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="max-w-2xl mx-auto px-4 py-8">
      <!-- ìŠ¤í… ì¸ë””ì¼€ì´í„° -->
      <div class="step-indicator">
        <div class="step-dot active" id="stepDot1"></div>
        <div class="step-dot" id="stepDot2"></div>
      </div>

      <!-- 1ë‹¨ê³„: ì´ë¦„, ì „í™”ë²ˆí˜¸ ì…ë ¥ -->
      <div id="step1">
        <div class="glass-card mb-6">
          <div class="text-center mb-6">
            <div class="w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center">
              <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
              </svg>
            </div>
            <h2 class="text-2xl font-bold text-gray-900 mb-2">ë¬¸ì˜í•˜ê¸°</h2>
            <p class="text-gray-600">ì´ë¦„ê³¼ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
          </div>

          <form id="loginForm" class="space-y-6">
            <div>
              <label for="name" class="block text-sm font-medium text-gray-700 mb-2">ì´ë¦„</label>
              <div class="relative">
                <input
                  id="name"
                  type="text"
                  class="input-glass pl-12"
                  placeholder="í™ê¸¸ë™"
                  maxlength="20"
                  required
                />
                <svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
              </div>
            </div>

            <div>
              <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">ì „í™”ë²ˆí˜¸</label>
              <div class="relative">
                <input
                  id="phone"
                  type="tel"
                  inputmode="numeric"
                  class="input-glass pl-12"
                  placeholder="01012345678"
                  maxlength="11"
                  required
                  aria-describedby="phoneHelp"
                />
                <svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                </svg>
              </div>
              <p id="phoneHelp" class="mt-2 text-sm text-gray-500">í•˜ì´í”ˆ(-) ì—†ì´ ìˆ«ìë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
            </div>

            <div id="error" class="hidden p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm"></div>

            <button type="submit" class="btn-primary-glass w-full" id="submitBtn">
              ë‹¤ìŒìœ¼ë¡œ
            </button>
          </form>
        </div>

        <!-- FAQ ì„¹ì…˜ -->
        <div class="faq-section">
          <h3 class="text-lg font-bold text-gray-900 mb-4">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</h3>

          <div class="faq-item">
            <button class="faq-question" onclick="toggleFaq(this)">
              <span>ì…ê¸ˆ í™•ì¸ì€ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ë‚˜ìš”?</span>
              <svg class="faq-chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-answer">
              ì…ê¸ˆ í™•ì¸ì€ ë³´í†µ ì˜ì—…ì¼ ê¸°ì¤€ 1-2ì¼ ë‚´ì— ì²˜ë¦¬ë©ë‹ˆë‹¤. ì…ê¸ˆìëª…ì´ ì‹ ì²­ìëª…ê³¼ ë‹¤ë¥¼ ê²½ìš° ì²˜ë¦¬ê°€ ì§€ì—°ë  ìˆ˜ ìˆìœ¼ë‹ˆ, ì…ê¸ˆ ì‹œ ì‹ ì²­ìëª…ìœ¼ë¡œ ì…ê¸ˆí•´ì£¼ì„¸ìš”.
            </div>
          </div>

          <div class="faq-item">
            <button class="faq-question" onclick="toggleFaq(this)">
              <span>ì‹ ì²­ ì·¨ì†ŒëŠ” ì–´ë–»ê²Œ í•˜ë‚˜ìš”?</span>
              <svg class="faq-chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-answer">
              ì‹ ì²­ ì·¨ì†ŒëŠ” ë¬¸ì˜í•˜ê¸°ë¥¼ í†µí•´ ìš”ì²­í•´ì£¼ì„¸ìš”. ì…ê¸ˆ ì „ ì·¨ì†ŒëŠ” ë°”ë¡œ ì²˜ë¦¬ë˜ë©°, ì…ê¸ˆ í›„ ì·¨ì†ŒëŠ” í™˜ë¶ˆ ì ˆì°¨ë¥¼ ê±°ì³ ì²˜ë¦¬ë©ë‹ˆë‹¤.
            </div>
          </div>

          <div class="faq-item">
            <button class="faq-question" onclick="toggleFaq(this)">
              <span>ë™ë°˜ì¸ ì •ë³´ ë³€ê²½ì´ ê°€ëŠ¥í•œê°€ìš”?</span>
              <svg class="faq-chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-answer">
              í–‰ì‚¬ ì „ê¹Œì§€ ë™ë°˜ì¸ì˜ ì „í™”ë²ˆí˜¸, ìƒë…„ì›”ì¼ ì •ë³´ ë³€ê²½ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì‹ ì²­í™•ì¸ ë©”ë‰´ì—ì„œ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
          </div>

          <div class="faq-item">
            <button class="faq-question" onclick="toggleFaq(this)">
              <span>í˜„ì¥ì—ì„œ ë³¸ì¸ í™•ì¸ì€ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?</span>
              <svg class="faq-chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-answer">
              í˜„ì¥ì—ì„œëŠ” ì‹ ë¶„ì¦ê³¼ ì‹ ì²­ í™•ì¸ í™”ë©´(ë˜ëŠ” QRì½”ë“œ)ì„ ì œì‹œí•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤. ë³¸ì¸ í™•ì¸ í›„ ì…ì¥ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </div>
          </div>
        </div>
      </div>

      <!-- 2ë‹¨ê³„: ë¬¸ì˜ë‚´ìš© ì…ë ¥ ë° ë‚´ì—­ í™•ì¸ -->
      <div id="step2" class="hidden">
        <!-- ì‚¬ìš©ì ì •ë³´ ë°°ë„ˆ -->
        <div class="user-info-banner">
          <div class="user-avatar" id="userAvatar">í™</div>
          <div class="user-info-text">
            <div class="user-name" id="userName">í™ê¸¸ë™</div>
            <div class="user-phone" id="userPhone">010-1234-5678</div>
          </div>
          <button onclick="goToStep1()" class="text-sm text-red-600 hover:underline">ë³€ê²½</button>
        </div>

        <!-- ë¬¸ì˜ ì‘ì„± ì¹´ë“œ -->
        <div class="glass-card mb-6">
          <h2 class="text-xl font-bold text-gray-900 mb-4">ìƒˆ ë¬¸ì˜ ì‘ì„±</h2>

          <form id="inquiryForm" class="space-y-4">
            <!-- ì¹´í…Œê³ ë¦¬ ì„ íƒ -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">ë¬¸ì˜ ìœ í˜•</label>
              <div class="category-grid">
                <div class="category-card" data-category="ì…ê¸ˆ/ê²°ì œ" onclick="selectCategory(this)">
                  <div class="icon">ğŸ’³</div>
                  <div class="label">ì…ê¸ˆ/ê²°ì œ</div>
                </div>
                <div class="category-card" data-category="ì·¨ì†Œ/í™˜ë¶ˆ" onclick="selectCategory(this)">
                  <div class="icon">â†©ï¸</div>
                  <div class="label">ì·¨ì†Œ/í™˜ë¶ˆ</div>
                </div>
                <div class="category-card" data-category="ì •ë³´ë³€ê²½" onclick="selectCategory(this)">
                  <div class="icon">âœï¸</div>
                  <div class="label">ì •ë³´ ë³€ê²½</div>
                </div>
                <div class="category-card" data-category="ê¸°íƒ€ë¬¸ì˜" onclick="selectCategory(this)">
                  <div class="icon">ğŸ’¬</div>
                  <div class="label">ê¸°íƒ€ ë¬¸ì˜</div>
                </div>
              </div>
              <input type="hidden" id="category" value="" />
            </div>

            <!-- í™˜ë¶ˆ ê³„ì¢Œ ì…ë ¥ (ì·¨ì†Œ/í™˜ë¶ˆ ì„ íƒ ì‹œë§Œ í‘œì‹œ) -->
            <div id="refundFields" class="hidden space-y-4 p-4 bg-yellow-50 rounded-xl border border-yellow-200">
              <p class="text-sm font-medium text-yellow-800 flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                í™˜ë¶ˆë°›ìœ¼ì‹¤ ê³„ì¢Œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”
              </p>
              <div>
                <label class="block text-sm text-gray-700 mb-1">í™˜ë¶ˆ ê¸ˆì•¡</label>
                <input type="text" id="refundAmount" class="input-glass" placeholder="ì˜ˆ: 35000 ë˜ëŠ” 70000" inputmode="numeric" />
              </div>
              <div>
                <label class="block text-sm text-gray-700 mb-1">í™˜ë¶ˆ ì€í–‰</label>
                <select id="refundBank" class="input-glass">
                  <option value="">ì€í–‰ ì„ íƒ</option>
                  <option value="KBêµ­ë¯¼ì€í–‰">KBêµ­ë¯¼ì€í–‰</option>
                  <option value="ì‹ í•œì€í–‰">ì‹ í•œì€í–‰</option>
                  <option value="ìš°ë¦¬ì€í–‰">ìš°ë¦¬ì€í–‰</option>
                  <option value="í•˜ë‚˜ì€í–‰">í•˜ë‚˜ì€í–‰</option>
                  <option value="NHë†í˜‘ì€í–‰">NHë†í˜‘ì€í–‰</option>
                  <option value="IBKê¸°ì—…ì€í–‰">IBKê¸°ì—…ì€í–‰</option>
                  <option value="ì¹´ì¹´ì˜¤ë±…í¬">ì¹´ì¹´ì˜¤ë±…í¬</option>
                  <option value="í† ìŠ¤ë±…í¬">í† ìŠ¤ë±…í¬</option>
                  <option value="ì¼€ì´ë±…í¬">ì¼€ì´ë±…í¬</option>
                  <option value="SCì œì¼ì€í–‰">SCì œì¼ì€í–‰</option>
                  <option value="ì”¨í‹°ì€í–‰">ì”¨í‹°ì€í–‰</option>
                  <option value="ëŒ€êµ¬ì€í–‰">ëŒ€êµ¬ì€í–‰</option>
                  <option value="ë¶€ì‚°ì€í–‰">ë¶€ì‚°ì€í–‰</option>
                  <option value="ê²½ë‚¨ì€í–‰">ê²½ë‚¨ì€í–‰</option>
                  <option value="ê´‘ì£¼ì€í–‰">ê´‘ì£¼ì€í–‰</option>
                  <option value="ì „ë¶ì€í–‰">ì „ë¶ì€í–‰</option>
                  <option value="ì œì£¼ì€í–‰">ì œì£¼ì€í–‰</option>
                  <option value="ìƒˆë§ˆì„ê¸ˆê³ ">ìƒˆë§ˆì„ê¸ˆê³ </option>
                  <option value="ì‹ í˜‘">ì‹ í˜‘</option>
                  <option value="ìš°ì²´êµ­">ìš°ì²´êµ­</option>
                  <option value="ìˆ˜í˜‘">ìˆ˜í˜‘</option>
                </select>
              </div>
              <div>
                <label class="block text-sm text-gray-700 mb-1">ê³„ì¢Œë²ˆí˜¸</label>
                <input type="text" id="refundAccount" class="input-glass" placeholder="- ì—†ì´ ìˆ«ìë§Œ ì…ë ¥" inputmode="numeric" />
              </div>
              <div>
                <label class="block text-sm text-gray-700 mb-1">ì˜ˆê¸ˆì£¼</label>
                <input type="text" id="refundHolder" class="input-glass" placeholder="ì˜ˆê¸ˆì£¼ëª…" />
              </div>
            </div>

            <!-- ë¬¸ì˜ ë‚´ìš© -->
            <div>
              <label for="content" class="block text-sm font-medium text-gray-700 mb-2">ë¬¸ì˜ ë‚´ìš©</label>
              <textarea
                id="content"
                class="input-glass"
                rows="5"
                placeholder="ë¬¸ì˜í•˜ì‹¤ ë‚´ìš©ì„ ìì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”"
                maxlength="1000"
                required
                oninput="updateCharCount()"
              ></textarea>
              <div class="char-counter" id="charCounter">0 / 1,000</div>
            </div>

            <div id="error2" class="hidden p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm"></div>

            <button type="submit" class="btn-primary-glass w-full" id="submitBtn2">
              ë¬¸ì˜ ì ‘ìˆ˜í•˜ê¸°
            </button>
          </form>
        </div>

        <!-- ë¬¸ì˜ ë‚´ì—­ -->
        <div class="glass-card">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-bold text-gray-900">ë‚´ ë¬¸ì˜ ë‚´ì—­</h3>
            <button onclick="loadInquiryHistory(currentPhone)" class="text-sm text-red-600 hover:underline flex items-center gap-1">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
              </svg>
              ìƒˆë¡œê³ ì¹¨
            </button>
          </div>
          <div id="inquiryHistory">
            <div class="text-center py-8 text-gray-500">ë¡œë”© ì¤‘...</div>
          </div>
        </div>
      </div>
    </main>

    <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ (ëª¨ë°”ì¼) -->
    <nav class="bottom-nav">
      <a href="/">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
        <span>í™ˆ</span>
      </a>
      <a href="/apply.html">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
        </svg>
        <span>ì‹ ì²­í•˜ê¸°</span>
      </a>
      <a href="/check.html">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span>í™•ì¸í•˜ê¸°</span>
      </a>
      <a href="/inquiry.html" class="active">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
        <span>ë¬¸ì˜í•˜ê¸°</span>
      </a>
      <a href="/story.html" style="color: #ea580c;">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
        </svg>
        <span>ì‚¬ì—°</span>
      </a>
    </nav>

    <!-- í† ìŠ¤íŠ¸ ì•Œë¦¼ -->
    <div id="toast" class="toast"></div>

    <!-- ì„±ê³µ ëª¨ë‹¬ -->
    <div id="successModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
      <div class="glass-card max-w-sm w-full text-center" style="animation: modalIn 0.3s ease-out;">
        <div class="mb-6 flex justify-center">
          <div class="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center">
            <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
          </div>
        </div>
        <h2 class="text-2xl font-bold text-gray-900 mb-2">ë¬¸ì˜ ì ‘ìˆ˜ ì™„ë£Œ!</h2>
        <p class="text-gray-600 mb-6">ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
        <button onclick="closeSuccessModal()" class="btn-primary-glass w-full">
          í™•ì¸
        </button>
      </div>
    </div>
  </div>

  <script>
    let currentName = '';
    let currentPhone = '';
    let selectedCategory = '';

    document.addEventListener('DOMContentLoaded', function() {
      const nameInput = document.getElementById('name');
      const phoneInput = document.getElementById('phone');
      const loginForm = document.getElementById('loginForm');
      const inquiryForm = document.getElementById('inquiryForm');
      const errorDiv = document.getElementById('error');
      const errorDiv2 = document.getElementById('error2');
      const submitBtn = document.getElementById('submitBtn');
      const submitBtn2 = document.getElementById('submitBtn2');

      if (!phoneInput || !loginForm || !nameInput) {
        console.error('Required elements not found');
        return;
      }

      // ì „í™”ë²ˆí˜¸ ìˆ«ìë§Œ ì…ë ¥
      phoneInput.addEventListener('keydown', (e) => {
        const allowedKeys = [
          'Backspace', 'Delete', 'Tab', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown',
          'Home', 'End'
        ];

        if (allowedKeys.includes(e.key)) return;

        if (!/^[0-9]$/.test(e.key)) {
          e.preventDefault();
          return;
        }

        if (phoneInput.value.length >= 11 && !allowedKeys.includes(e.key)) {
          e.preventDefault();
        }
      });

      phoneInput.addEventListener('input', (e) => {
        const value = e.target.value.replace(/[^0-9]/g, '');
        phoneInput.value = value.slice(0, 11);
      });

      // 1ë‹¨ê³„: ì´ë¦„, ì „í™”ë²ˆí˜¸ ì…ë ¥
      loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        errorDiv.classList.add('hidden');

        const name = nameInput.value.trim();
        const phone = phoneInput.value.replace(/[^0-9]/g, '');

        if (!name || name.length < 2) {
          showError('ì´ë¦„ì„ 2ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.', errorDiv);
          return;
        }

        if (phone.length !== 11) {
          showError('ì „í™”ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”. (11ìë¦¬)', errorDiv);
          return;
        }

        currentName = name;
        currentPhone = phone;

        // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
        document.getElementById('userAvatar').textContent = currentName.charAt(0);
        document.getElementById('userName').textContent = currentName;
        document.getElementById('userPhone').textContent = formatPhone(phone);

        goToStep2();
        loadInquiryHistory(phone);
      });

      // 2ë‹¨ê³„: ë¬¸ì˜ë‚´ìš© ì œì¶œ
      if (inquiryForm) {
        inquiryForm.addEventListener('submit', async (e) => {
          e.preventDefault();
          errorDiv2.classList.add('hidden');

          const content = document.getElementById('content').value.trim();
          const category = document.getElementById('category').value;

          if (!category) {
            showError('ë¬¸ì˜ ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', errorDiv2);
            return;
          }

          if (!content) {
            showError('ë¬¸ì˜ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', errorDiv2);
            return;
          }

          if (content.length < 10) {
            showError('ë¬¸ì˜ë‚´ìš©ì„ 10ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.', errorDiv2);
            return;
          }

          // ì·¨ì†Œ/í™˜ë¶ˆì¸ ê²½ìš° í™˜ë¶ˆ ì •ë³´ ìˆ˜ì§‘
          let refundInfo = '';
          if (category === 'ì·¨ì†Œ/í™˜ë¶ˆ') {
            const refundAmount = document.getElementById('refundAmount').value.trim();
            const refundBank = document.getElementById('refundBank').value;
            const refundAccount = document.getElementById('refundAccount').value.replace(/[^0-9]/g, '');
            const refundHolder = document.getElementById('refundHolder').value.trim();

            if (refundAmount || refundBank || refundAccount || refundHolder) {
              refundInfo = `\n\n[í™˜ë¶ˆì •ë³´]\nê¸ˆì•¡: ${refundAmount || 'ë¯¸ì…ë ¥'}ì›\nì€í–‰: ${refundBank || 'ë¯¸ì„ íƒ'}\nê³„ì¢Œ: ${refundAccount || 'ë¯¸ì…ë ¥'}\nì˜ˆê¸ˆì£¼: ${refundHolder || 'ë¯¸ì…ë ¥'}`;
            }
          }

          submitBtn2.disabled = true;
          submitBtn2.innerHTML = '<span class="inline-block animate-spin mr-2">â†»</span> ì ‘ìˆ˜ ì¤‘...';

          try {
            const response = await fetch('/api/inquiries', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                user_name: currentName,
                phone: currentPhone,
                content: `[${category}] ${content}${refundInfo}`
              }),
            });

            const data = await response.json();

            if (!response.ok) {
              throw new Error(data.error || 'ë¬¸ì˜ ì ‘ìˆ˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }

            document.getElementById('successModal').classList.remove('hidden');
            loadInquiryHistory(currentPhone);

            // í¼ ì´ˆê¸°í™”
            document.getElementById('content').value = '';
            document.getElementById('category').value = '';
            selectedCategory = '';
            document.querySelectorAll('.category-card').forEach(c => c.classList.remove('selected'));
            document.getElementById('refundFields').classList.add('hidden');
            document.getElementById('refundAmount').value = '';
            document.getElementById('refundBank').value = '';
            document.getElementById('refundAccount').value = '';
            document.getElementById('refundHolder').value = '';
            updateCharCount();
          } catch (err) {
            console.error('Submit error:', err);
            showError(err.message || 'ë¬¸ì˜ ì ‘ìˆ˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', errorDiv2);
          } finally {
            submitBtn2.disabled = false;
            submitBtn2.textContent = 'ë¬¸ì˜ ì ‘ìˆ˜í•˜ê¸°';
          }
        });
      }
    });

    function goToStep1() {
      document.getElementById('step1').classList.remove('hidden');
      document.getElementById('step2').classList.add('hidden');
      document.getElementById('stepDot1').classList.add('active');
      document.getElementById('stepDot1').classList.remove('completed');
      document.getElementById('stepDot2').classList.remove('active');
    }

    function goToStep2() {
      document.getElementById('step1').classList.add('hidden');
      document.getElementById('step2').classList.remove('hidden');
      document.getElementById('stepDot1').classList.remove('active');
      document.getElementById('stepDot1').classList.add('completed');
      document.getElementById('stepDot2').classList.add('active');
    }

    function selectCategory(element) {
      document.querySelectorAll('.category-card').forEach(c => c.classList.remove('selected'));
      element.classList.add('selected');
      selectedCategory = element.dataset.category;
      document.getElementById('category').value = selectedCategory;

      // ì·¨ì†Œ/í™˜ë¶ˆ ì„ íƒ ì‹œ í™˜ë¶ˆ ê³„ì¢Œ ì…ë ¥ í•„ë“œ í‘œì‹œ
      const refundFields = document.getElementById('refundFields');
      if (selectedCategory === 'ì·¨ì†Œ/í™˜ë¶ˆ') {
        refundFields.classList.remove('hidden');
      } else {
        refundFields.classList.add('hidden');
      }
    }

    function updateCharCount() {
      const content = document.getElementById('content');
      const counter = document.getElementById('charCounter');
      const length = content.value.length;

      counter.textContent = `${length.toLocaleString()} / 1,000`;
      counter.classList.remove('warning', 'danger');

      if (length > 900) {
        counter.classList.add('danger');
      } else if (length > 700) {
        counter.classList.add('warning');
      }
    }

    function formatPhone(phone) {
      if (phone.length === 11) {
        return `${phone.slice(0, 3)}-${phone.slice(3, 7)}-${phone.slice(7)}`;
      }
      return phone;
    }

    async function loadInquiryHistory(phone) {
      const historyDiv = document.getElementById('inquiryHistory');
      if (!historyDiv) return;

      historyDiv.innerHTML = `
        <div class="text-center py-8">
          <div class="inline-block animate-spin text-2xl mb-2">â†»</div>
          <p class="text-gray-500">ë¬¸ì˜ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
      `;

      try {
        const response = await fetch(`/api/inquiries/phone/${phone}`);
        const data = await response.json();

        if (!response.ok) {
          throw new Error(data.error || 'ë¬¸ì˜ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }

        const inquiries = data.inquiries || [];

        if (inquiries.length === 0) {
          historyDiv.innerHTML = `
            <div class="text-center py-12">
              <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
              </svg>
              <p class="text-gray-500">ì•„ì§ ë¬¸ì˜ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
              <p class="text-sm text-gray-400 mt-1">ìœ„ì—ì„œ ìƒˆ ë¬¸ì˜ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</p>
            </div>
          `;
          return;
        }

        historyDiv.innerHTML = inquiries.map(inq => {
          // ì¹´í…Œê³ ë¦¬ ì¶”ì¶œ
          let category = 'ê¸°íƒ€ë¬¸ì˜';
          let content = inq.content;
          const categoryMatch = inq.content.match(/^\[([^\]]+)\]\s*/);
          if (categoryMatch) {
            category = categoryMatch[1];
            content = inq.content.replace(categoryMatch[0], '');
          }

          return `
            <div class="inquiry-card">
              <div class="inquiry-card-header">
                <span class="text-sm text-gray-500">${formatDateTime(inq.created_at)}</span>
                ${inq.is_answered
                  ? '<span class="inquiry-status answered"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg> ë‹µë³€ ì™„ë£Œ</span>'
                  : '<span class="inquiry-status waiting"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/></svg> ë‹µë³€ ëŒ€ê¸°</span>'
                }
              </div>
              <div class="inquiry-card-body">
                <span class="inquiry-category">${category}</span>
                <p class="inquiry-content">${escapeHtml(content)}</p>

                ${inq.is_answered ? `
                  <div class="answer-section">
                    <div class="answer-label">
                      <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/>
                      </svg>
                      ë‹µë³€
                    </div>
                    <p class="inquiry-content text-sm">${escapeHtml(inq.answer)}</p>
                    <p class="text-xs text-gray-400 mt-2">${formatDateTime(inq.answered_at)}</p>
                  </div>
                ` : ''}
              </div>
            </div>
          `;
        }).join('');
      } catch (err) {
        console.error('Load history error:', err);
        historyDiv.innerHTML = `
          <div class="text-center py-8 text-red-500">
            <svg class="w-12 h-12 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <p>ë¬¸ì˜ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
            <button onclick="loadInquiryHistory(currentPhone)" class="mt-2 text-sm underline">ë‹¤ì‹œ ì‹œë„</button>
          </div>
        `;
      }
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function formatDateTime(dateTimeStr) {
      if (!dateTimeStr) return '-';
      try {
        const dateStr = dateTimeStr.replace(' ', 'T');
        const date = new Date(dateStr);
        return date.toLocaleString('ko-KR', {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit',
          hour12: false,
          timeZone: 'Asia/Seoul'
        });
      } catch (e) {
        return dateTimeStr;
      }
    }

    function showError(message, errorElement) {
      if (errorElement) {
        errorElement.textContent = message;
        errorElement.classList.remove('hidden');
        errorElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
      } else {
        showToast(message);
      }
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    function closeSuccessModal() {
      document.getElementById('successModal').classList.add('hidden');
    }

    function toggleFaq(button) {
      const faqItem = button.closest('.faq-item');
      const isOpen = faqItem.classList.contains('open');

      // ë‹¤ë¥¸ FAQ ë‹«ê¸°
      document.querySelectorAll('.faq-item').forEach(item => {
        item.classList.remove('open');
      });

      // í˜„ì¬ FAQ í† ê¸€
      if (!isOpen) {
        faqItem.classList.add('open');
      }
    }
  </script>
</body>
</html>
